%% Sequence diagram: Place Order (detailed)

sequenceDiagram
    actor User
    participant MenuScreen
    participant InventoryService
    participant CartService
    participant OrderService
    participant SupabaseDB
    participant NotificationService

    User->>MenuScreen: Add product to cart
    MenuScreen->>InventoryService: checkAvailability(productId)
    alt available
        InventoryService-->>MenuScreen: OK
        MenuScreen->>CartService: addToCart(product, qty)
        CartService-->>MenuScreen: cartUpdated
    else not available
        InventoryService-->>MenuScreen: Not available
        MenuScreen-->>User: show out-of-stock
    end

    User->>CartService: Checkout
    CartService->>OrderService: createOrder(cart)
    OrderService->>InventoryService: reserveItems(order)
    alt reserved
        InventoryService-->>OrderService: reserved
        OrderService->>SupabaseDB: saveOrder(order)
        SupabaseDB-->>OrderService: orderSaved
        OrderService->>NotificationService: sendOrderConfirmation
        NotificationService-->>User: order confirmed
    else reservation failed
        InventoryService-->>OrderService: reservation failed
        OrderService-->>CartService: show error
    end
