%% Network Architecture Diagram for FastFood Application
%% Shows detailed ports, protocols, and connections

graph TB
  subgraph DevEnvironment["Development Environment"]
    subgraph LocalMachine["Developer Machine"]
      MobileDev["Mobile Dev<br/>üì± Expo CLI<br/>Port: 8081<br/>Metro: 19000-19002"]
      WebDev["Web Dev<br/>üåê Vite Server<br/>Port: 5173<br/>HMR: WebSocket"]
      PaymentDev["Payment Server<br/>‚ö° Node.js/Express<br/>Port: 3000<br/>CORS enabled"]
    end
  end

  subgraph ClientDevices["Client Devices"]
    MobileDevice["üì± Mobile Device<br/>React Native App<br/>AsyncStorage<br/>Expo Go/Custom Build"]
    WebBrowser["üñ•Ô∏è Web Browser<br/>React SPA<br/>LocalStorage<br/>localhost:5173"]
  end

  subgraph CloudServices["Cloud Services"]
    subgraph SupabaseCloud["Supabase Cloud"]
      SupabaseAPI["üîå REST API<br/>Port: 443 (HTTPS)<br/>JWT Authentication<br/>Rate Limited"]
      SupabaseDB["üóÑÔ∏è PostgreSQL<br/>Port: 5432 (Internal)<br/>Connection Pooling<br/>RLS Enabled"]
      SupabaseRT["‚ö° Realtime<br/>Port: 443 (WSS)<br/>WebSocket<br/>Presence & Broadcast"]
      SupabaseAuth["üîê Auth Service<br/>JWT Tokens<br/>OAuth Providers<br/>Session Management"]
    end
    
    subgraph PaymentGateway["Payment Services"]
      MoMoAPI["üí≥ MoMo API<br/>Port: 443 (HTTPS)<br/>HMAC-SHA256 Auth<br/>Webhook Support"]
      MoMoCallback["üîÑ Webhook Endpoint<br/>IPN Notifications<br/>Payment Status Updates"]
    end
  end

  subgraph ProductionInfra["Production Infrastructure"]
    AppStores["üì± App Stores<br/>iOS App Store<br/>Google Play Store<br/>OTA Updates"]
    WebHosting["üåê Web Hosting<br/>Netlify/Vercel<br/>CDN Distribution<br/>HTTPS/SSL"]
    ServerHosting["‚ö° Server Hosting<br/>Railway/Heroku<br/>Auto-scaling<br/>Health Checks"]
  end

  %% Development Connections
  MobileDev -.->|"USB/WiFi<br/>8081"| MobileDevice
  WebDev -.->|"HTTP<br/>5173"| WebBrowser
  PaymentDev -.->|"HTTP<br/>3000"| WebBrowser
  PaymentDev -.->|"HTTP<br/>3000"| MobileDevice

  %% Client to Cloud Connections (Development)
  MobileDevice -->|"HTTPS<br/>443<br/>JWT Auth"| SupabaseAPI
  MobileDevice -->|"WSS<br/>443<br/>Real-time"| SupabaseRT
  WebBrowser -->|"HTTPS<br/>443<br/>JWT Auth"| SupabaseAPI
  WebBrowser -->|"WSS<br/>443<br/>Real-time"| SupabaseRT

  %% Payment Connections
  MobileDevice -->|"HTTPS<br/>3000<br/>POST /checkout"| PaymentDev
  WebBrowser -->|"HTTPS<br/>3000<br/>POST /checkout"| PaymentDev
  PaymentDev -->|"HTTPS<br/>443<br/>Create Payment"| MoMoAPI
  MoMoAPI -->|"HTTPS<br/>3000<br/>IPN Callback"| PaymentDev

  %% Backend Internal Connections
  SupabaseAPI -.->|"Internal<br/>5432<br/>SQL Queries"| SupabaseDB
  SupabaseRT -.->|"Internal<br/>DB Changes"| SupabaseDB
  SupabaseAuth -.->|"Internal<br/>User Validation"| SupabaseDB
  PaymentDev -->|"HTTPS<br/>443<br/>Service Role"| SupabaseAPI

  %% Production Deployment Flows
  MobileDev -.->|"Build & Deploy"| AppStores
  WebDev -.->|"Build & Deploy"| WebHosting
  PaymentDev -.->|"Deploy"| ServerHosting

  %% Production Client Connections
  AppStores -->|"HTTPS<br/>443"| SupabaseAPI
  WebHosting -->|"HTTPS<br/>443"| SupabaseAPI
  ServerHosting -->|"HTTPS<br/>443"| SupabaseAPI
  AppStores -->|"HTTPS<br/>Production URL"| ServerHosting
  WebHosting -->|"HTTPS<br/>Production URL"| ServerHosting

  %% Styling
  classDef development fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
  classDef client fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
  classDef cloud fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
  classDef production fill:#fff3e0,stroke:#ef6c00,stroke-width:2px

  class DevEnvironment,LocalMachine,MobileDev,WebDev,PaymentDev development
  class ClientDevices,MobileDevice,WebBrowser client
  class CloudServices,SupabaseCloud,SupabaseAPI,SupabaseDB,SupabaseRT,SupabaseAuth,PaymentGateway,MoMoAPI,MoMoCallback cloud
  class ProductionInfra,AppStores,WebHosting,ServerHosting production